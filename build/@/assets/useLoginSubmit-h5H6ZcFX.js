import{r as d,A as O,i as E,b as I,k as R,a as l}from"./index-2mfuo06O.js";import{u as k}from"./index.esm-oyxLbiW2.js";import{A as n}from"./AdminServices-eYhEMPW4.js";import{n as m,a as o}from"./toast-THQY2iqr.js";import{u as v}from"./useDispatch-YK8G-cGq.js";const w=()=>{const S=v(),[h,e]=d.useState(!1),{dispatch:c}=d.useContext(O),u=E(),i=I(),{register:y,handleSubmit:x,formState:{errors:b}}=k();return{onSubmit:({name:A,email:f,verifyEmail:L,password:g,role:N})=>{e(!0);const p=.5;i.pathname==="/login"&&(S(R("globalSetting")),n.loginAdmin({email:f,password:g}).then(s=>{e(!1),s.status==="true"?(console.log("res",s.data),m("Login Success!"),c({type:"USER_LOGIN",payload:s.data}),l.set("adminInfo",JSON.stringify(s.data),{expires:p,sameSite:"None",secure:!0}),u.replace("/")):o(s.message)}).catch(s=>{var t,a;o(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)})),i.pathname==="/signup"&&n.registerAdmin({name:A,email:f,password:g,role:N}).then(s=>{s&&(e(!1),m("Register Success!"),c({type:"USER_LOGIN",payload:s}),l.set("adminInfo",JSON.stringify(s),{expires:p,sameSite:"None",secure:!0}),u.replace("/"))}).catch(s=>{var t,a;o(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)}),i.pathname==="/forgot-password"&&n.forgetPassword({verifyEmail:L}).then(s=>{e(!1),m(s.message)}).catch(s=>{var t,a;e(!1),o(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message))})},register:y,handleSubmit:x,errors:b,loading:h}};export{w as u};
