import{r as j,S as P,j as e,d as s,L as k,t as F,u as A}from"./index-2mfuo06O.js";import{U as I}from"./UploadManyTwo-XrcHZwm9.js";import{d as U,u as M}from"./index-rWeN10LT.js";import{S as B,f as R}from"./Layout-81CakcO1.js";import{T as S,D as L,u as Y,M as _}from"./DrawerButton-jrPwNvY7.js";import{D as q,T as O,E as V}from"./EditDeleteButton-pWUCRk3G.js";import{E as u}from"./AdminServices-eYhEMPW4.js";import{I as b}from"./InputArea-0PJ48ZNn.js";import{u as H,L as f}from"./index.esm-oyxLbiW2.js";import{b as w}from"./ProductServices-iGXESm1R.js";import{a as D,n as J}from"./toast-THQY2iqr.js";import{T as Z}from"./TableLoading-bxls4ttA.js";import{N as $}from"./NotFound--3n1hw2X.js";import{P as z}from"./PageTitle-WlGR2KdD.js";import{u as G}from"./useFilter-Z8DqJX9m.js";import"./exportFromJSON-vc2Lqcy6.js";import"./iconBase-c39LCkAf.js";import"./spinner-R50PTWTV.js";import"./httpService-FN6G_Hsy.js";import"./useDispatch-YK8G-cGq.js";const K=a=>{const[o,m]=j.useState(""),[c,t]=j.useState(!1),{closeDrawer:l,setIsUpdate:p}=j.useContext(P),{register:C,handleSubmit:y,setValue:x,formState:{errors:N}}=H(),g=async d=>{var h,r;try{t(!0);const i={name:d.name,email:d.email,phone:d.phone,address:d.address};if(a){const n=await w.updateCustomer(a,i);p(!0),J(n.message),l()}t(!1)}catch(i){D(((r=(h=i==null?void 0:i.response)==null?void 0:h.data)==null?void 0:r.message)||(i==null?void 0:i.message)),l()}};return j.useEffect(()=>{a&&(async()=>{var d,h;try{const r=await w.getCustomerById(a);r&&(x("name",r.name),x("phone",r.phone),x("email",r.email),x("address",r.address))}catch(r){D(((h=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:h.message)||(r==null?void 0:r.message))}})()},[a,x]),{register:C,handleSubmit:y,onSubmit:g,errors:N,setImageUrl:m,imageUrl:o,isSubmitting:c}},Q=({id:a})=>{const{register:o,handleSubmit:m,onSubmit:c,errors:t,isSubmitting:l}=K(a);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:a?e.jsx(S,{title:"Update Customer",description:"Update your Customer necessary information from here"}):e.jsx(S,{title:"Add Customer",description:"Add your Customer necessary information from here"})}),e.jsx(B,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:m(c),children:[e.jsxs("div",{className:"px-6 pt-8 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(f,{label:"Name"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(b,{register:o,label:"Name",name:"name",type:"text",placeholder:"Name"}),e.jsx(u,{errorName:t.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(f,{label:"Email"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(b,{register:o,label:"Email",name:"email",type:"email",placeholder:"Email"}),e.jsx(u,{errorName:t.email})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(f,{label:"Phone"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(b,{required:!0,register:o,label:"Phone",name:"phone",type:"text",placeholder:"Phone"}),e.jsx(u,{errorName:t.phone})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(f,{label:"Address"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(b,{required:!0,register:o,label:"Address",name:"address",type:"text",placeholder:"Address"}),e.jsx(u,{errorName:t.address})]})]})]}),e.jsx(L,{id:a,title:"Customer",isSubmitting:l})]})})]})},W=({customers:a})=>{const{title:o,serviceId:m,handleModalOpen:c,handleUpdate:t}=Y();return e.jsxs(e.Fragment,{children:[e.jsx(q,{id:m,title:o}),e.jsx(_,{children:e.jsx(Q,{id:m})}),e.jsx(s.TableBody,{children:a==null?void 0:a.map(l=>{var p;return e.jsxs(s.TableRow,{children:[e.jsx(s.TableCell,{children:e.jsxs("span",{className:"font-semibold uppercase text-xs",children:[" ",(p=l==null?void 0:l._id)==null?void 0:p.substring(20,24)]})}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm",children:U(l.createdAt).format("MMM D, YYYY")})}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm",children:l.name})}),e.jsxs(s.TableCell,{children:[e.jsx("span",{className:"text-sm",children:l.email})," "]}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm font-medium",children:l.mobile})}),e.jsx(s.TableCell,{children:e.jsxs("div",{className:"flex justify-end text-right",children:[e.jsxs("div",{className:"p-2 cursor-pointer text-gray-400 hover:text-emerald-600",children:[" ",e.jsx(k,{to:`/customer-order/${l._id}`,children:e.jsx(O,{id:"view",Icon:R,title:F("ViewOrder"),bgColor:"#34D399"})})]}),e.jsx(V,{title:l.name,id:l._id,handleUpdate:t,handleModalOpen:c})]})})]},l._id)})})]})},fe=()=>{var T,v;const{data:a,loading:o,error:m}=M(w.getAllCustomers);console.log("customer",a);const{userRef:c,dataTable:t,serviceData:l,filename:p,isDisabled:C,setSearchUser:y,totalResults:x,resultsPerPage:N,handleSubmitUser:g,handleSelectFile:d,handleChangePage:h,handleUploadMultiple:r,handleRemoveSelectFile:i}=G((T=a==null?void 0:a.data)==null?void 0:T.docs),{t:n}=A(),E=()=>{y(""),c.current.value=""};return e.jsxs(e.Fragment,{children:[e.jsx(z,{children:n("CustomersPage")}),e.jsx(s.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(s.CardBody,{children:e.jsx("form",{onSubmit:g,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:e.jsx("div",{className:"items-center",children:e.jsx(I,{title:"Customers",exportData:(v=a==null?void 0:a.data)==null?void 0:v.docs,filename:p,isDisabled:C,handleSelectFile:d,handleUploadMultiple:r,handleRemoveSelectFile:i})})})})}),e.jsx(s.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(s.CardBody,{children:e.jsxs("form",{onSubmit:g,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsxs("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx(s.Input,{ref:c,type:"search",name:"search",placeholder:n("CustomersPageSearchPlaceholder")}),e.jsx("button",{type:"submit",className:"absolute right-0 top-0 mt-5 mr-1"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(s.Button,{type:"submit",className:"h-12 w-full bg-emerald-700",children:"Filter"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(s.Button,{layout:"outline",onClick:E,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})})]})]})})}),o?e.jsx(Z,{row:12,col:6,width:190,height:20}):m?e.jsx("span",{className:"text-center mx-auto text-red-500",children:m}):(l==null?void 0:l.length)!==0?e.jsxs(s.TableContainer,{className:"mb-8",children:[e.jsxs(s.Table,{children:[e.jsx(s.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(s.TableCell,{children:n("CustomersId")}),e.jsx(s.TableCell,{children:n("CustomersJoiningDate")}),e.jsx(s.TableCell,{children:n("CustomersName")}),e.jsx(s.TableCell,{children:n("CustomersEmail")}),e.jsx(s.TableCell,{children:n("CustomersPhone")}),e.jsx(s.TableCell,{className:"text-right",children:n("CustomersActions")})]})}),e.jsx(W,{customers:t})]}),e.jsx(s.TableFooter,{children:e.jsx(s.Pagination,{totalResults:x,resultsPerPage:N,onChange:h,label:"Table navigation"})})]}):e.jsx($,{title:"Sorry, There are no customers right now."})]})};export{fe as default};
