import{r as l,A as O,k as E,e as I,l as R,b as d}from"./index-n-Mj-w5F.js";import{u as k}from"./index.esm-cFreCkwr.js";import{A as n}from"./AdminServices-G0hlKUD3.js";import{n as m,a as o}from"./toast--43O7F4z.js";import{u as v}from"./useDispatch-oTJCh-Ew.js";const w=()=>{const S=v(),[h,e]=l.useState(!1),{dispatch:c}=l.useContext(O),u=E(),i=I(),{register:y,handleSubmit:x,formState:{errors:b}}=k();return{onSubmit:({name:A,email:f,verifyEmail:L,password:g,role:N})=>{e(!0);const p=.5;i.pathname==="/login"&&(S(R("globalSetting")),n.loginAdmin({email:f,password:g}).then(s=>{e(!1),s.status==="true"?(console.log("res",s.data),m("Login Success!"),c({type:"USER_LOGIN",payload:s.data}),d.set("adminInfo",JSON.stringify(s.data),{expires:p,sameSite:"None",secure:!0}),u.replace("/")):o(s.message)}).catch(s=>{var t,a;o(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)})),i.pathname==="/signup"&&n.registerAdmin({name:A,email:f,password:g,role:N}).then(s=>{s&&(e(!1),m("Register Success!"),c({type:"USER_LOGIN",payload:s}),d.set("adminInfo",JSON.stringify(s),{expires:p,sameSite:"None",secure:!0}),u.replace("/"))}).catch(s=>{var t,a;o(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)}),i.pathname==="/forgot-password"&&n.forgetPassword({verifyEmail:L}).then(s=>{e(!1),m(s.message)}).catch(s=>{var t,a;e(!1),o(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message))})},register:y,handleSubmit:x,errors:b,loading:h}};export{w as u};
