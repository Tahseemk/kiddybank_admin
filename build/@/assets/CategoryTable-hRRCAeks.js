import{r as j,S as G,u as J,j as e,d as m,L as V}from"./index-n-Mj-w5F.js";import{S as Q,I as W}from"./Layout-Uoy8HDDZ.js";import{C as X,S as Z}from"./ShowHideButton-0v0Cvicz.js";import{T as q,D as y,u as ee,M as se}from"./DrawerButton-CC7bgkMS.js";import{D as ae,E as te}from"./EditDeleteButton-RGitrSAk.js";import{T as ne,b as re,S as le}from"./BulkActionDrawer-IN1fGV6Z.js";import{a as B,n as $}from"./toast--43O7F4z.js";import{E as z}from"./AdminServices-G0hlKUD3.js";import{I as ie}from"./InputArea-BBW6Yhkf.js";import{u as de,L}from"./index.esm-cFreCkwr.js";import{U as oe}from"./Uploader-8ANEOpFA.js";import{C as P}from"./ProductServices-ppfcihlB.js";import{u as K}from"./PageTitle-tRfcP2yT.js";const me=(d,p)=>{const{isDrawerOpen:t,closeDrawer:b,setIsUpdate:c,lang:S}=j.useContext(G),[v,C]=j.useState({}),[N,w]=j.useState(""),[D,x]=j.useState(""),[_,s]=j.useState([]),[r,h]=j.useState(S),[o,T]=j.useState(!0),[A,E]=j.useState(""),[U,f]=j.useState(!1),{register:H,handleSubmit:a,setValue:n,clearErrors:l,reset:I,formState:{errors:F}}=de(),Y=async({name:g,description:i})=>{var M,R;try{f(!0);const u={name:{[r]:g},description:{[r]:i||""},parentId:N||void 0,parentName:A||"Home",icon:D,status:o?"show":"hide",lang:r};console.log("category submit",u),f(!1);return}catch(u){f(!1),B(u?(R=(M=u==null?void 0:u.response)==null?void 0:M.data)==null?void 0:R.message:u==null?void 0:u.message),b()}},k=g=>{h(g),Object.keys(v).length>0&&(n("name",v.name[g||"en"]),n("description",v.description[g||"en"]))};return j.useEffect(()=>{var g;if(!t){C({}),n("name"),n("parentId"),n("parentName"),n("description"),n("icon"),x(""),T(!0),l("name"),l("parentId"),l("parentName"),l("description"),E("Home"),h(S),n("language",r),p!==void 0&&((g=p[0])==null?void 0:g._id)!==void 0&&w(p[0]._id);return}d&&(async()=>{try{const i=await P.getCategoryById(d);i&&(C(i),n("name",i.name[r||"en"]),n("description",i.description[r||"en"]),n("language",r),n("parentId",i.parentId),n("parentName",i.parentName),E(i.parentName),w(i.parentId),x(i.icon),T(i.status==="show"))}catch(i){B(i?i.response.data.message:i.message)}})()},[d,n,t,r,l,p,S]),{register:H,handleSubmit:a,onSubmit:Y,errors:F,imageUrl:D,setImageUrl:x,children:_,setChildren:s,published:o,setPublished:T,checked:N,setChecked:w,isSubmitting:U,selectCategoryName:A,setSelectCategoryName:E,handleSelectLanguage:k}},pe=({id:d,data:p})=>{const{t}=J(),{checked:b,register:c,onSubmit:S,handleSubmit:v,errors:C,imageUrl:N,setImageUrl:w,published:D,setPublished:x,setChecked:_,selectCategoryName:s,setSelectCategoryName:r,handleSelectLanguage:h,isSubmitting:o}=me(d,p),{showingTranslateValue:T}=K(),A=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`,E={motionName:"node-motion",motionAppear:!1,onAppearStart:a=>({height:0}),onAppearActive:a=>({height:a.scrollHeight}),onLeaveStart:a=>({height:a.offsetHeight}),onLeaveActive:()=>({height:0})},U=a=>{let n=[];for(let l of a)n.push({title:T(l.name),key:l._id,children:l.children.length>0&&U(l.children)});return n},f=(a,n)=>{var l;return a._id===n?a:(l=a==null?void 0:a.children)==null?void 0:l.reduce((I,F)=>I??f(F,n),void 0)},H=async a=>{if(a!==void 0)if(d){const n=await P.getCategoryById(a);if(d===a)return B("This can't be select as a parent category!");if(d===n.parentId)return B("This can't be select as a parent category!");{if(a===void 0)return;_(a);const l=p[0],I=f(l,a);r(T(I==null?void 0:I.name))}}else{if(a===void 0)return;_(a);const n=p[0],l=f(n,a);r(T(l==null?void 0:l.name))}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:d?e.jsx(q,{register:c,handleSelectLanguage:h,title:t("UpdateCategory"),description:t("UpdateCategoryDescription")}):e.jsx(q,{register:c,handleSelectLanguage:h,title:t("AddCategoryTitle"),description:t("AddCategoryDescription")})}),e.jsx(Q,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:v(S),children:[e.jsxs("div",{className:"p-6 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("Name")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ie,{register:c,label:"Category title",name:"name",type:"text",placeholder:t("ParentCategoryPlaceholder")}),e.jsx(z,{errorName:C.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("Description")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ne,{required:!0,register:c,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(z,{errorName:C.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("ParentCategory")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4 relative",children:[e.jsx(m.Input,{readOnly:!0,...c("parent",{required:!1}),name:"parent",value:s||"Home",placeholder:t("ParentCategory"),type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:A}}),e.jsx(re,{expandAction:"click",treeData:U(p),selectedKeys:[b],onSelect:a=>H(a[0]),motion:E,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("CategoryIcon")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(oe,{imageUrl:N,setImageUrl:w,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("Published")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(le,{handleProcess:x,processOption:D})})]})]}),e.jsx(y,{id:d,title:"Category",isSubmitting:o})]})})]})},Te=({data:d,lang:p,isCheck:t,categories:b,setIsCheck:c,useParamId:S,showChild:v})=>{const{title:C,serviceId:N,handleModalOpen:w,handleUpdate:D}=ee(),{showingTranslateValue:x}=K(),_=s=>{const{id:r,checked:h}=s.target;c([...t,r]),h||c(t.filter(o=>o!==r))};return e.jsxs(e.Fragment,{children:[(t==null?void 0:t.length)<1&&e.jsx(ae,{useParamId:S,id:N,title:C}),e.jsx(se,{children:e.jsx(pe,{id:N,data:d,lang:p})}),e.jsx(m.TableBody,{children:b==null?void 0:b.map(s=>{var r,h;return e.jsxs(m.TableRow,{children:[e.jsx(m.TableCell,{children:e.jsx(X,{type:"checkbox",name:"category",id:s._id,handleClick:_,isChecked:t==null?void 0:t.includes(s._id)})}),e.jsx(m.TableCell,{className:"font-semibold uppercase text-xs",children:(r=s==null?void 0:s._id)==null?void 0:r.substring(20,24)}),e.jsx(m.TableCell,{children:s!=null&&s.icon?e.jsx(m.Avatar,{className:"hidden mr-3 md:block bg-gray-50 p-1",src:s==null?void 0:s.icon,alt:s==null?void 0:s.parent}):e.jsx(m.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"})}),e.jsx(m.TableCell,{className:"font-medium text-sm ",children:(s==null?void 0:s.children.length)>0?e.jsxs(V,{to:`/categories/${s==null?void 0:s._id}`,className:"text-blue-700",children:[x(s==null?void 0:s.name),e.jsx(e.Fragment,{children:v&&e.jsxs(e.Fragment,{children:[" ",e.jsx("div",{className:"pl-2 ",children:(h=s==null?void 0:s.children)==null?void 0:h.map(o=>e.jsx("div",{children:e.jsx(V,{to:`/categories/${o==null?void 0:o._id}`,className:"text-blue-700",children:e.jsxs("div",{className:"flex text-xs items-center  text-blue-800",children:[e.jsx("span",{className:" text-xs text-gray-500 pr-1",children:e.jsx(W,{})}),e.jsx("span",{className:"text-gray-500",children:x(o.name)})]})})},o._id))})]})})]}):e.jsx("span",{children:x(s==null?void 0:s.name)})}),e.jsx(m.TableCell,{className:"text-sm",children:x(s==null?void 0:s.description)}),e.jsx(m.TableCell,{className:"text-center",children:e.jsx(Z,{id:s._id,category:!0,status:s.status})}),e.jsx(m.TableCell,{children:e.jsx(te,{id:s==null?void 0:s._id,parent:s,isCheck:t,children:s==null?void 0:s.children,handleUpdate:D,handleModalOpen:w,title:x(s==null?void 0:s.name)})})]},s._id)})})]})};export{pe as C,Te as a};
