import{j as e,d as t,r as b,S as _,u as H}from"./index-2mfuo06O.js";import{c as $}from"./Layout-81CakcO1.js";import{u as z}from"./index-rWeN10LT.js";import{u as V,M as v}from"./DrawerButton-jrPwNvY7.js";import{U as G}from"./UploadManyTwo-XrcHZwm9.js";import{N as K}from"./NotFound--3n1hw2X.js";import{a as Q,P as k,c as W,r as X,u as Y}from"./ProductServices-iGXESm1R.js";import{u as Z,P as ee}from"./PageTitle-WlGR2KdD.js";import{P as L}from"./ProductDrawer-YuO5yhZ2.js";import{D as q,E as se}from"./EditDeleteButton-pWUCRk3G.js";import{B as te}from"./BulkActionDrawer-oP8QF6UU.js";import"./httpService-FN6G_Hsy.js";import{a as P,n as E}from"./toast-THQY2iqr.js";import{T as ae}from"./TableLoading-bxls4ttA.js";import"./iconBase-c39LCkAf.js";import"./spinner-R50PTWTV.js";import"./exportFromJSON-vc2Lqcy6.js";import"./useDispatch-YK8G-cGq.js";import"./index-RN3srjkx.js";import"./index.esm-oyxLbiW2.js";import"./Uploader-sWpIRVQW.js";import"./tslib.es6-YYMLUA4o.js";import"./AdminServices-eYhEMPW4.js";const le=({products:g,isCheck:d,setIsCheck:h})=>{const{title:u,serviceId:f,handleModalOpen:m,handleUpdate:p}=V(),{currency:S,showingTranslateValue:j,getNumberTwo:x}=Z();return console.log("Products",g),e.jsxs(e.Fragment,{children:[(d==null?void 0:d.length)<1&&e.jsx(q,{id:f,title:u}),(d==null?void 0:d.length)<2&&e.jsx(v,{children:e.jsx(L,{currency:S,id:f})}),e.jsx(t.TableBody,{children:g==null?void 0:g.map((s,C)=>{var T;return e.jsxs(t.TableRow,{children:[e.jsx(t.TableCell,{children:e.jsxs("div",{className:"flex items-center",children:[s!=null&&s.image?e.jsx(t.Avatar,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",src:s==null?void 0:s.image,alt:"product"}):e.jsx(t.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product"}),e.jsx("div",{children:e.jsx("h2",{className:`text-sm font-medium ${s==null?void 0:s.productName}`,children:(T=s==null?void 0:s.productName)==null?void 0:T.substring(0,28)})})]})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm font-semibold",children:x(s==null?void 0:s.price)})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm font-semibold",children:x(s==null?void 0:s.dailyIncome)})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm font-semibold",children:x(s==null?void 0:s.totalIncome)})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm font-semibold",children:x(s==null?void 0:s.monthly)})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm font-semibold",children:x(s==null?void 0:s.totalDays)})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm font-semibold",children:x(s==null?void 0:s.percentage)})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm font-semibold",children:s==null?void 0:s.planType})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm font-semibold",children:s==null?void 0:s.risk})}),e.jsx(t.TableCell,{children:e.jsx(se,{id:s._id,product:s,isCheck:d,handleUpdate:p,handleModalOpen:m,title:j(s==null?void 0:s.title)})})]},C+1)})})]})},re={type:"object",properties:{categories:{type:"array"},image:{type:"array"},tag:{type:"array"},variants:{type:"array"},show:{type:"array"},status:{type:"string"},prices:{type:"object"},isCombination:{type:"boolean"},title:{type:"object"},productId:{type:"string"},slug:{type:"string"},category:{type:"object"},stock:{type:"number"},description:{type:"object"}},required:["categories","category","prices","title"]},ie=g=>{const d=new Q({allErrors:!0}),{setLoading:h,setIsUpdate:u}=b.useContext(_),[f]=b.useState([]),[m,p]=b.useState([]),[S,j]=b.useState(""),[x,s]=b.useState(!1);return{data:g,filename:S,isDisabled:x,handleSelectFile:async c=>{var N;c.preventDefault();const a=new FileReader,r=(N=c.target)==null?void 0:N.files[0];if(r&&r.type==="application/json")j(r==null?void 0:r.name),s(!0),a.readAsText(r,"UTF-8"),a.onload=o=>{const w=JSON.parse(o.target.result).map(l=>({categories:l.categories,image:l.image,barcode:l.barcode,tag:l.tag,variants:l.variants,status:l.status,prices:l.prices,isCombination:l.isCombination,title:l.title,productId:l.productId,slug:l.slug,sku:l.sku,category:l.category,stock:l.stock,description:l.description}));p(w)};else if(r&&r.type==="text/csv")j(r==null?void 0:r.name),s(!0),a.onload=async o=>{const y=o.target.result,l=(await W().fromString(y)).map(i=>({categories:JSON.parse(i.categories),image:JSON.parse(i.image),barcode:i.barcode,tag:JSON.parse(i.tag),variants:JSON.parse(i.variants),status:i.status,prices:JSON.parse(i.prices),isCombination:JSON.parse(i.isCombination),title:JSON.parse(i.title),productId:i.productId,slug:i.slug,sku:i.sku,category:JSON.parse(i.category),stock:JSON.parse(i.stock),description:JSON.parse(i.description)}));p(l)},a.readAsText(r);else{j(r==null?void 0:r.name),s(!0);const o=!!a.readAsBinaryString;a.onload=function(y){const w=y.target.result,l=X(w,{type:o?"binary":"array",bookVBA:!0}),i=l.SheetNames[0],F=l.Sheets[i],J=Y.sheet_to_json(F).map(n=>({categories:JSON.parse(n.categories),image:JSON.parse(n.image),barcode:n.barcode,tag:JSON.parse(n.tag),variants:JSON.parse(n.variants),status:n.status,prices:JSON.parse(n.prices),isCombination:JSON.parse(n.isCombination),title:JSON.parse(n.title),productId:n.productId,slug:n.slug,sku:n.sku,category:JSON.parse(n.category),stock:JSON.parse(n.stock),description:JSON.parse(n.description)}));p(J)},o?a.readAsBinaryString(r):a.readAsArrayBuffer(r)}},serviceData:g,handleOnDrop:c=>{for(let a=0;a<c.length;a++)f.push(c[a].data)},handleUploadProducts:()=>{f.length<1?P("Please upload/select csv file first!"):k.addAllProducts(f).then(c=>{E(c.message)}).catch(c=>P(c.message))},handleRemoveSelectFile:c=>{j(""),p([]),setTimeout(()=>s(!1),1e3)},handleUploadMultiple:c=>{if(m.length>1){h(!0);let a=m.map(o=>d.validate(re,o));const r=o=>o===!0;a.every(r)?k.addAllProducts(m).then(o=>{u(!0),h(!1),E(o.message)}).catch(o=>{h(!1),P(o.message)}):(h(!1),P("Please enter valid data!"))}else h(!1),P("Please select a valid json, csv & xls file first!")}}},Je=()=>{var R,U,M;const{title:g,allId:d,serviceId:h,handleDeleteMany:u,handleUpdateMany:f}=V(),{t:m}=H(),{toggleDrawer:p,lang:S,currentPage:j,handleChangePage:x,searchText:s,category:C,setCategory:T,searchRef:D,handleSubmitForAll:O,sortedField:A,setSortedField:I,limitData:c}=b.useContext(_),{data:a,loading:r,error:N}=z(()=>k.getAllProducts({page:j,limit:c,category:C,title:s,price:A}));console.log("ProductData",a),b.useState(!1);const[o,y]=b.useState([]),w=()=>{T(""),I(""),D.current.value=""},{serviceData:l,filename:i,isDisabled:F,handleSelectFile:B,handleUploadMultiple:J,handleRemoveSelectFile:n}=ie((R=a==null?void 0:a.data)==null?void 0:R.docs);return e.jsxs(e.Fragment,{children:[e.jsx(ee,{children:m("ProductsPage")}),e.jsx(q,{ids:d,setIsCheck:y,title:g}),e.jsx(te,{ids:d,title:"Products"}),e.jsx(v,{children:e.jsx(L,{id:h})}),e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(t.CardBody,{className:"",children:e.jsxs("form",{onSubmit:O,className:"py-3 md:pb-0 grid gap-4 lg:gap-6 xl:gap-6 xl:flex",children:[e.jsx("div",{className:"flex-grow-0 sm:flex-grow md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(G,{title:"Products",filename:i,isDisabled:F,totalDoc:a==null?void 0:a.totalDoc,handleSelectFile:B,handleUploadMultiple:J,handleRemoveSelectFile:n})}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{onClick:p,className:"w-full rounded-md h-12",children:[e.jsx("span",{className:"mr-2",children:e.jsx($,{})}),m("AddProduct")]})})})]})})}),e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsx(t.CardBody,{children:e.jsxs("form",{onSubmit:O,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsxs("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx(t.Input,{ref:D,type:"search",name:"search",placeholder:"Search Product"}),e.jsx("button",{type:"submit",className:"absolute right-0 top-0 mt-5 mr-1"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(t.Button,{type:"submit",className:"h-12 w-full bg-emerald-700",children:"Filter"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(t.Button,{layout:"outline",onClick:w,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})})]})]})})}),r?e.jsx(ae,{row:12,col:7,width:160,height:20}):N?e.jsx("span",{className:"text-center mx-auto text-red-500",children:N}):(l==null?void 0:l.length)!==0?e.jsxs(t.TableContainer,{className:"mb-8 rounded-b-lg",children:[e.jsxs(t.Table,{children:[e.jsx(t.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(t.TableCell,{children:m("ProductNameTbl")}),e.jsx(t.TableCell,{children:m("PriceTbl")}),e.jsx(t.TableCell,{children:"Daily Income"}),e.jsx(t.TableCell,{children:"Total Income"}),e.jsx(t.TableCell,{children:"Total Monthl"}),e.jsx(t.TableCell,{children:"Days"}),e.jsx(t.TableCell,{children:"Percentage"}),e.jsx(t.TableCell,{children:"Plan Type"}),e.jsx(t.TableCell,{children:"Risk"}),e.jsx(t.TableCell,{className:"text-right",children:m("ActionsTbl")})]})}),e.jsx(le,{lang:S,isCheck:o,products:(U=a==null?void 0:a.data)==null?void 0:U.docs,setIsCheck:y})]}),e.jsx(t.TableFooter,{children:e.jsx(t.Pagination,{totalResults:(M=a==null?void 0:a.data)==null?void 0:M.total,resultsPerPage:c,onChange:x,label:"Product Page Navigation"})})]}):e.jsx(K,{title:"Product"})]})};export{Je as default};
